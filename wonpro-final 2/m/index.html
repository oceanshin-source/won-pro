<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>íšŒì› í˜ì´ì§€</title>
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#6366f1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>*{font-family:-apple-system,'Malgun Gothic',sans-serif;box-sizing:border-box}</style>
</head>
<body class="bg-gray-50">
<div id="app"></div>
<script>
const SUPABASE_URL = 'https://sniabexwdgeepakkxxek.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNuaWFiZXh3ZGdlZXBha2t4eGVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1MDMxNzIsImV4cCI6MjA4NTA3OTE3Mn0.RsDQDyawjFk5voFLVouXDlTIXvhPrsziCD37ne-1jMU';
const db = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// URLì—ì„œ í•™ì› ì½”ë“œ ê°€ì ¸ì˜¤ê¸° (wonpro.pages.dev/m/ABC123)
const pathParts = window.location.pathname.split('/');
const academyCode = pathParts[pathParts.length - 1] || pathParts[pathParts.length - 2];

let page = 'login';
let academy = null;
let member = null;
let tab = 'home';
let notices = [];
let attendance = [];
let loading = false;

// ì¿ íŒ¡ ê´‘ê³  ë¡œì§ (3~10% ëœë¤)
function getCoupangRate() {
  const today = new Date();
  const seed = today.getFullYear() * 10000 + (today.getMonth()+1) * 100 + today.getDate();
  const x = Math.sin(seed) * 10000;
  const rand = x - Math.floor(x);
  return 3 + rand * 7;
}

function tryCoupangCookie(categories) {
  const rate = getCoupangRate();
  if (Math.random() * 100 < rate) {
    const defaultUrl = 'https://link.coupang.com/a/example';
    window.open(defaultUrl, '_blank');
  }
}

async function init() {
  if (!academyCode || academyCode === 'm') {
    document.getElementById('app').innerHTML = '<div class="min-h-screen flex items-center justify-center text-gray-500">ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤</div>';
    return;
  }
  
  const { data } = await db.from('academies').select('*').eq('code', academyCode).single();
  if (!data) {
    document.getElementById('app').innerHTML = '<div class="min-h-screen flex items-center justify-center text-gray-500">í•™ì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
    return;
  }
  
  // ì„±ì¸íšŒì› ì ‘ì† í—ˆìš© ì²´í¬
  if (data.allow_member === false) {
    document.getElementById('app').innerHTML = '<div class="min-h-screen flex items-center justify-center text-gray-500"><div class="text-center"><div class="text-4xl mb-4">ğŸš«</div><p>í˜„ì¬ íšŒì› ì ‘ì†ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><p class="text-sm mt-2">í•™ì›ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.</p></div></div>';
    return;
  }
  
  academy = data;
  render();
}

async function login() {
  const phone = document.getElementById('phone').value.trim();
  if (phone.length !== 4) {
    alert('ì „í™”ë²ˆí˜¸ ë’¤ 4ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
    return;
  }
  
  loading = true;
  render();
  
  // ì„±ì¸íšŒì›ì€ ë³¸ì¸ ì „í™”ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸ (pPhoneì´ ì•„ë‹Œ phone)
  const { data, error } = await db.from('students')
    .select('*')
    .eq('academy_id', academy.id)
    .like('phone', `%${phone}`)
    .single();
  
  if (error || !data) {
    alert('ë“±ë¡ëœ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
    loading = false;
    render();
    return;
  }
  
  // ê°œë³„ ì°¨ë‹¨ ì²´í¬
  if (data.blocked) {
    alert('ì ‘ì†ì´ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤. í•™ì›ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
    loading = false;
    render();
    return;
  }
  
  member = data;
  tryCoupangCookie(academy.categories);
  
  await loadData();
  loading = false;
  page = 'main';
  render();
}

async function loadData() {
  const { data: n } = await db.from('notices').select('*').eq('academy_id', academy.id).order('created_at', { ascending: false }).limit(10);
  notices = n || [];
  
  const { data: a } = await db.from('attendance').select('*').eq('student_id', member.id).order('date', { ascending: false }).limit(30);
  attendance = a || [];
}

function render() {
  const app = document.getElementById('app');
  if (page === 'login') {
    app.innerHTML = renderLogin();
  } else {
    app.innerHTML = renderMain();
  }
}

function renderLogin() {
  return `
    <div class="min-h-screen flex flex-col">
      <!-- ê´‘ê³  ì˜ì—­ -->
      <div class="bg-amber-50 p-3 text-center text-sm">
        <a href="https://link.coupang.com/a/example" target="_blank" class="text-amber-800">
          ğŸ‹ï¸ ìš´ë™ìš©í’ˆ/ê±´ê°•ì‹í’ˆ ì¿ íŒ¡ì—ì„œ í™•ì¸!
        </a>
      </div>
      
      <div class="flex-1 flex items-center justify-center p-6">
        <div class="w-full max-w-sm">
          <div class="text-center mb-8">
            <div class="w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-4xl">ğŸ‘¤</span>
            </div>
            <h1 class="text-2xl font-bold text-gray-800">${academy?.name || 'í•™ì›'}</h1>
            <p class="text-gray-500 mt-1">íšŒì› í˜ì´ì§€</p>
          </div>
          
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <label class="text-sm text-gray-600 block mb-2">ë‚´ ì „í™”ë²ˆí˜¸ ë’¤ 4ìë¦¬</label>
            <input type="tel" id="phone" maxlength="4" placeholder="0000" 
              class="w-full text-center text-3xl tracking-widest py-4 border-2 rounded-xl focus:border-indigo-500 focus:outline-none"
              onkeypress="if(event.key==='Enter')login()">
            <button onclick="login()" 
              class="w-full mt-4 py-4 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-colors"
              ${loading ? 'disabled' : ''}>
              ${loading ? 'ë¡œê·¸ì¸ ì¤‘...' : 'ë¡œê·¸ì¸'}
            </button>
          </div>
          
          <p class="text-center text-gray-400 text-sm mt-6">
            ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤
          </p>
        </div>
      </div>
    </div>
  `;
}

function renderMain() {
  const tabs = [
    { id: 'home', icon: 'ğŸ ', label: 'í™ˆ' },
    { id: 'community', icon: 'ğŸ“‹', label: 'ì»¤ë®¤ë‹ˆí‹°' },
    { id: 'attendance', icon: 'ğŸ“…', label: 'ì¶œê²°' },
    { id: 'notices', icon: 'ğŸ“¢', label: 'ê³µì§€' },
    { id: 'payment', icon: 'ğŸ’³', label: 'ê²°ì œ' }
  ];
  
  let h = `
    <div class="min-h-screen pb-20">
      <!-- í—¤ë” -->
      <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4">
        <div class="flex justify-between items-center">
          <div>
            <div class="text-sm opacity-80">${academy.name}</div>
            <div class="text-xl font-bold">${member.name}ë‹˜</div>
          </div>
          <button onclick="logout()" class="px-3 py-1 bg-white/20 rounded-lg text-sm">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
      </div>
  `;
  
  // í™ˆ
  if (tab === 'home') {
    const todayAtt = attendance[0];
    const unpaid = !member.paid;
    const scheduleStr = member.schedule ? Object.entries(member.schedule).map(([d,t])=>`${d} ${t}`).join(', ') : '-';
    const totalAttend = attendance.filter(a => a.status === 'ì¶œì„').length;
    
    h += `
      <div class="p-4 space-y-4">
        <!-- ì˜¤ëŠ˜ ì¶œì„ -->
        <div class="bg-white rounded-2xl p-5 shadow-sm">
          <div class="flex items-center justify-between mb-3">
            <h3 class="font-bold">ğŸ“… ì˜¤ëŠ˜ ì¶œì„</h3>
            <span class="px-3 py-1 rounded-full text-sm ${todayAtt ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-100 text-gray-500'}">
              ${todayAtt ? 'âœ“ ì¶œì„ì™„ë£Œ' : 'ë¯¸ì¶œì„'}
            </span>
          </div>
          <div class="text-sm text-gray-500">ìˆ˜ì—… ì¼ì •: ${scheduleStr}</div>
        </div>
        
        <!-- ìˆ˜ê°• ì •ë³´ -->
        <div class="bg-white rounded-2xl p-5 shadow-sm">
          <h3 class="font-bold mb-3">ğŸ“š ìˆ˜ê°• ì •ë³´</h3>
          <div class="space-y-2 text-sm">
            <div class="flex justify-between"><span class="text-gray-500">ê³¼ëª©</span><span class="font-medium">${member.course || '-'}</span></div>
            <div class="flex justify-between"><span class="text-gray-500">ë ˆë²¨</span><span class="font-medium">${member.level || '-'}</span></div>
            <div class="flex justify-between"><span class="text-gray-500">ì´ë²ˆë‹¬ ì¶œì„</span><span class="font-medium text-indigo-600">${totalAttend}íšŒ</span></div>
          </div>
        </div>
        
        <!-- ìˆ˜ê°•ë£Œ -->
        <div class="bg-white rounded-2xl p-5 shadow-sm">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="font-bold">ğŸ’° ìˆ˜ê°•ë£Œ</h3>
              <div class="text-2xl font-bold mt-1">${(member.fee || 0).toLocaleString()}ì›</div>
            </div>
            <div class="text-right">
              ${unpaid 
                ? `<span class="px-3 py-1 bg-red-100 text-red-600 rounded-full text-sm">ë¯¸ë‚©</span>
                   <button onclick="requestPayment()" class="mt-2 block px-4 py-2 bg-indigo-600 text-white rounded-xl text-sm">ë‚©ë¶€í•˜ê¸°</button>`
                : `<span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm">ë‚©ë¶€ì™„ë£Œ</span>`
              }
            </div>
          </div>
        </div>
        
        <!-- í¬ì¸íŠ¸ -->
        <div class="bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl p-5 text-white">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="font-bold">ğŸ† ì¶œì„ í¬ì¸íŠ¸</h3>
              <div class="text-3xl font-bold mt-1">${member.points || 0}ì </div>
            </div>
            <div class="text-5xl">ğŸ¯</div>
          </div>
        </div>
        
        <!-- ìµœê·¼ ê³µì§€ -->
        ${notices.length ? `
        <div class="bg-white rounded-2xl p-5 shadow-sm">
          <h3 class="font-bold mb-3">ğŸ“¢ ìµœê·¼ ê³µì§€</h3>
          ${notices.slice(0, 2).map(n => `
            <div class="py-2 border-b last:border-0">
              <div class="font-medium text-sm">${n.title}</div>
              <div class="text-xs text-gray-400">${new Date(n.created_at).toLocaleDateString('ko-KR')}</div>
            </div>
          `).join('')}
        </div>` : ''}
      </div>
    `;
  }
  
  // ì»¤ë®¤ë‹ˆí‹°
  else if (tab === 'community') {
    h += `
      <div class="p-4">
        <div class="flex justify-between items-center mb-4">
          <h2 class="font-bold text-lg">ğŸ“‹ ì»¤ë®¤ë‹ˆí‹°</h2>
          <button onclick="openWritePost()" class="px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-sm">âœï¸ ê¸€ì“°ê¸°</button>
        </div>
        
        <!-- íˆ¬í‘œ -->
        <div class="bg-violet-50 rounded-2xl p-4 mb-4">
          <h3 class="font-bold text-violet-700 mb-3">ğŸ—³ï¸ ì§„í–‰ì¤‘ì¸ íˆ¬í‘œ</h3>
          <div class="bg-white rounded-xl p-4">
            <div class="font-medium mb-2">2ì›” ë³´ê°• í¬ë§ ìš”ì¼</div>
            <div class="space-y-2">
              ${['ì›”ìš”ì¼','í™”ìš”ì¼','ìˆ˜ìš”ì¼','í† ìš”ì¼'].map((opt,i) => {
                const votes = [3,5,2,8][i];
                const total = 18;
                const pct = Math.round(votes/total*100);
                return `<button onclick="vote(${i})" class="w-full relative">
                  <div class="absolute inset-0 bg-violet-100 rounded-lg" style="width:${pct}%"></div>
                  <div class="relative flex justify-between items-center p-2 text-sm">
                    <span>${opt}</span>
                    <span class="text-violet-600">${pct}%</span>
                  </div>
                </button>`;
              }).join('')}
            </div>
            <div class="text-xs text-gray-400 mt-2">18ëª… ì°¸ì—¬ Â· 2/5 ë§ˆê°</div>
          </div>
        </div>
        
        <!-- ê²Œì‹œê¸€ -->
        <div class="space-y-3">
          <div class="bg-white rounded-2xl p-4 shadow-sm border-l-4 border-indigo-400">
            <div class="text-xs text-indigo-600 font-bold mb-1">ğŸ“Œ ê³ ì •</div>
            <div class="flex items-center gap-2 mb-2">
              <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-sm">ê¹€</div>
              <div>
                <div class="font-medium text-sm">ê¹€ì˜ì–´ ì›ì¥</div>
                <div class="text-xs text-gray-400">1ì£¼ ì „</div>
              </div>
            </div>
            <p class="text-sm">ìš°ë¦¬ í•™ì› ì»¤ë®¤ë‹ˆí‹°ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</p>
            <div class="flex gap-4 mt-3 text-sm text-gray-500">
              <button onclick="likePost('1')">â¤ï¸ 5</button>
              <button onclick="viewComments('1')">ğŸ’¬ 3</button>
            </div>
          </div>
          
          <div class="bg-white rounded-2xl p-4 shadow-sm">
            <div class="flex items-center gap-2 mb-2">
              <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-sm">íšŒ</div>
              <div>
                <div class="font-medium text-sm">ë‹¤ë¥¸ íšŒì›ë‹˜</div>
                <div class="text-xs text-gray-400">3ì‹œê°„ ì „</div>
              </div>
            </div>
            <p class="text-sm">ì˜¤ëŠ˜ ìˆ˜ì—… ì •ë§ ìœ ìµí–ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!</p>
            <div class="flex gap-4 mt-3 text-sm text-gray-500">
              <button onclick="likePost('2')">â¤ï¸ 6</button>
              <button onclick="viewComments('2')">ğŸ’¬ 1</button>
            </div>
          </div>
        </div>
        
        <!-- ì¼ì •/ìë£Œ ë°”ë¡œê°€ê¸° -->
        <div class="grid grid-cols-2 gap-3 mt-4">
          <button onclick="viewEvents()" class="bg-cyan-50 rounded-xl p-4 text-left">
            <div class="text-2xl mb-1">ğŸ“…</div>
            <div class="font-medium text-sm">ì¼ì •</div>
            <div class="text-xs text-gray-500">ë‹¤ê°€ì˜¤ëŠ” í–‰ì‚¬</div>
          </button>
          <button onclick="viewMaterials()" class="bg-emerald-50 rounded-xl p-4 text-left">
            <div class="text-2xl mb-1">ğŸ“š</div>
            <div class="font-medium text-sm">ìë£Œì‹¤</div>
            <div class="text-xs text-gray-500">í•™ìŠµ ìë£Œ</div>
          </button>
        </div>
        
        <!-- ìµëª… ê±´ì˜ -->
        <button onclick="openSuggestion()" class="w-full mt-4 bg-gray-100 rounded-xl p-4 text-left">
          <div class="flex items-center gap-3">
            <div class="text-2xl">ğŸ’¡</div>
            <div>
              <div class="font-medium text-sm">ìµëª… ê±´ì˜í•¨</div>
              <div class="text-xs text-gray-500">ì†”ì§í•œ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì„¸ìš”</div>
            </div>
          </div>
        </button>
      </div>
    `;
  }
  
  // ì¶œê²°
  else if (tab === 'attendance') {
    const totalDays = attendance.length;
    const presentDays = attendance.filter(a => a.status === 'ì¶œì„').length;
    const rate = totalDays > 0 ? Math.round(presentDays / totalDays * 100) : 0;
    
    h += `
      <div class="p-4">
        <div class="bg-white rounded-2xl p-5 shadow-sm mb-4">
          <div class="text-center">
            <div class="text-5xl font-bold text-indigo-600">${rate}%</div>
            <div class="text-gray-500 mt-1">ì¶œì„ë¥  (${presentDays}/${totalDays}ì¼)</div>
          </div>
        </div>
        
        <h2 class="font-bold text-lg mb-3">ì¶œê²° ê¸°ë¡</h2>
        <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
          ${attendance.length
            ? attendance.slice(0, 15).map(a => `
                <div class="flex items-center justify-between p-3 border-b">
                  <div class="text-sm">${a.date}</div>
                  <span class="px-2 py-1 rounded text-xs ${a.status === 'ì¶œì„' ? 'bg-indigo-100 text-indigo-700' : a.status === 'ì§€ê°' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}">
                    ${a.status}
                  </span>
                </div>
              `).join('')
            : '<p class="p-4 text-gray-400 text-center">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>'
          }
        </div>
      </div>
    `;
  }
  
  // ì¼ì •
  else if (tab === 'schedule') {
    const scheduleStr = member.schedule ? Object.entries(member.schedule).map(([d,t])=>`${d} ${t}`).join(', ') : '-';
    const days = member.schedule ? Object.keys(member.schedule) : [];
    
    h += `
      <div class="p-4">
        <div class="bg-white rounded-2xl p-5 shadow-sm mb-4">
          <h3 class="font-bold mb-4">ğŸ—“ï¸ ë‚´ ìˆ˜ì—… ì¼ì •</h3>
          <div class="text-lg font-medium text-indigo-600 mb-4">${scheduleStr}</div>
          
          <div class="grid grid-cols-7 gap-1 text-center text-sm">
            ${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].map(d => `
              <div class="py-2 rounded ${days.includes(d) ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-400'}">${d}</div>
            `).join('')}
          </div>
        </div>
        
        <div class="bg-white rounded-2xl p-5 shadow-sm">
          <h3 class="font-bold mb-3">ğŸ“ í•™ì› ì •ë³´</h3>
          <div class="space-y-2 text-sm">
            <div class="flex items-start gap-2">
              <span class="text-gray-400">ğŸ“</span>
              <span>${academy.phone || '-'}</span>
            </div>
            <div class="flex items-start gap-2">
              <span class="text-gray-400">ğŸ“</span>
              <span>${academy.address || '-'}</span>
            </div>
          </div>
        </div>
      </div>
    `;
  }
  
  // ê³µì§€
  else if (tab === 'notices') {
    h += `
      <div class="p-4">
        <h2 class="font-bold text-lg mb-4">ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
        <div class="space-y-3">
          ${notices.length
            ? notices.map(n => `
                <div class="bg-white rounded-2xl p-4 shadow-sm">
                  <div class="font-bold">${n.title}</div>
                  <div class="text-sm text-gray-600 mt-2">${n.content || ''}</div>
                  <div class="text-xs text-gray-400 mt-2">${new Date(n.created_at).toLocaleDateString('ko-KR')}</div>
                </div>
              `).join('')
            : '<p class="text-gray-400 text-center py-8">ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤</p>'
          }
        </div>
      </div>
    `;
  }
  
  // ê²°ì œ
  else if (tab === 'payment') {
    h += `
      <div class="p-4">
        <div class="bg-white rounded-2xl p-5 shadow-sm mb-4">
          <h3 class="font-bold mb-3">ğŸ’³ ê²°ì œ ì •ë³´</h3>
          <div class="flex items-center justify-between py-3 border-b">
            <span class="text-gray-500">ìˆ˜ê°•ë£Œ</span>
            <span class="text-xl font-bold">${(member.fee || 0).toLocaleString()}ì›</span>
          </div>
          <div class="flex items-center justify-between py-3">
            <span class="text-gray-500">ë‚©ë¶€ ìƒíƒœ</span>
            <span class="px-3 py-1 rounded-full text-sm ${member.paid ? 'bg-emerald-100 text-emerald-700' : 'bg-red-100 text-red-600'}">
              ${member.paid ? 'ë‚©ë¶€ì™„ë£Œ' : 'ë¯¸ë‚©'}
            </span>
          </div>
        </div>
        
        ${!member.paid ? `
        <button onclick="requestPayment()" class="w-full py-4 bg-indigo-600 text-white font-bold rounded-2xl">
          ğŸ’³ ì¹´ë“œ ê²°ì œí•˜ê¸°
        </button>
        ` : `
        <div class="bg-emerald-50 rounded-2xl p-5 text-center">
          <div class="text-4xl mb-2">âœ…</div>
          <div class="font-bold text-emerald-700">ì´ë²ˆ ë‹¬ ìˆ˜ê°•ë£Œê°€ ë‚©ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤</div>
        </div>
        `}
        
        <div class="mt-4 p-4 bg-gray-100 rounded-xl text-sm text-gray-500">
          <p>â€¢ ê²°ì œ ê´€ë ¨ ë¬¸ì˜: ${academy.phone || 'í•™ì› ë¬¸ì˜'}</p>
          <p>â€¢ í™˜ë¶ˆ ê·œì •ì€ í•™ì›ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”</p>
        </div>
      </div>
    `;
  }
  
  // í•˜ë‹¨ íƒ­
  h += `
      <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex">
        ${tabs.map(t => `
          <button onclick="tab='${t.id}';render()" class="flex-1 py-3 text-center ${tab === t.id ? 'text-indigo-600' : 'text-gray-400'}">
            <div class="text-xl">${t.icon}</div>
            <div class="text-xs">${t.label}</div>
          </button>
        `).join('')}
      </nav>
    </div>
  `;
  
  return h;
}

function logout() {
  member = null;
  page = 'login';
  tab = 'home';
  render();
}

function requestPayment() {
  alert('ê²°ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.\ní•™ì›ì— ì§ì ‘ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
}

// ì»¤ë®¤ë‹ˆí‹° í•¨ìˆ˜ë“¤
function openWritePost() {
  const content = prompt('ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:');
  if (!content) return;
  submitPost(content);
}

async function submitPost(content) {
  await db.from('posts').insert({
    academy_id: academy.id,
    author_type: 'member',
    author_name: member.name + ' íšŒì›',
    content
  });
  alert('ê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

function likePost(id) {
  alert('ì¢‹ì•„ìš”!');
}

function viewComments(id) {
  alert('ëŒ“ê¸€ ë³´ê¸° (ê°œë°œì¤‘)');
}

function vote(optionIndex) {
  alert('íˆ¬í‘œ ì™„ë£Œ!');
}

function viewEvents() {
  alert('ì¼ì • ë³´ê¸° (ê°œë°œì¤‘)');
}

function viewMaterials() {
  alert('ìë£Œì‹¤ (ê°œë°œì¤‘)');
}

function openSuggestion() {
  const content = prompt('ê±´ì˜ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš” (ìµëª…ìœ¼ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤):');
  if (!content) return;
  submitSuggestion(content);
}

async function submitSuggestion(content) {
  await db.from('suggestions').insert({
    academy_id: academy.id,
    content
  });
  alert('ê±´ì˜ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!');
}

init();
</script>
</body>

<footer class="bg-gray-100 border-t p-4 text-xs text-gray-500 text-center space-y-1 mt-8">
  <p><strong>ìƒí˜¸ëª…:</strong> ì´ë“  | <strong>ëŒ€í‘œì:</strong> ë°•í¬ìˆ™ | <strong>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:</strong> 655-61-00946</p>
  <p><strong>ì‚¬ì—…ì¥ì£¼ì†Œ:</strong> ì¸ì²œê´‘ì—­ì‹œ ì—°ìˆ˜êµ¬ í•˜ëª¨ë‹ˆë¡œ178ë²ˆê¸¸ 22, 7ì¸µ 707-ë§ˆ41í˜¸(ì†¡ë„ë™)</p>
  <p><strong>ì „í™”ë²ˆí˜¸:</strong> 032-670-9224 | <strong>í†µì‹ íŒë§¤ì—…ë²ˆí˜¸:</strong> ì œ0000-ì¸ì²œì—°ìˆ˜-0000í˜¸</p>
</footer>
</html>
